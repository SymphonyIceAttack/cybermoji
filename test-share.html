<!DOCTYPE html>
<html>
<head><title>Test Share</title></head>
<body>
<button id="testShare">Test Share</button>
<script>
// Debug navigator.canShare
console.log('navigator.share:', typeof navigator.share);
console.log('navigator.canShare:', typeof navigator.canShare);

async function testShare() {
  const canvas = document.createElement('canvas');
  canvas.width = 256;
  canvas.height = 256;
  const ctx = canvas.getContext('2d');
  ctx.fillStyle = '#ffffff';
  ctx.fillRect(0, 0, 256, 256);
  ctx.font = '150px Arial';
  ctx.textAlign = 'center';
  ctx.textBaseline = 'middle';
  ctx.fillText('ðŸ˜€', 128, 128);

  const blob = await new Promise(resolve => canvas.toBlob(resolve, 'image/png'));
  console.log('Blob size:', blob?.size);
  console.log('Blob type:', blob?.type);
  
  const file = new File([blob], 'emoji.png', { type: 'image/png' });
  console.log('File size:', file.size);
  console.log('File type:', file.type);
  
  if (navigator.canShare && navigator.canShare({ files: [file] })) {
    console.log('canShare with files: true');
    try {
      await navigator.share({ title: 'Test', files: [file] });
      console.log('Share success');
    } catch (e) {
      console.log('Share error:', e);
    }
  } else {
    console.log('canShare with files: false');
  }
}

document.getElementById('testShare').addEventListener('click', testShare);
</script>
</body>
</html>
